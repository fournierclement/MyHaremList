var insertHarem = function(req,res,callback){

    if (req.session.login != req.params.iduser) {
        return res.status(401).send("You aren't authentified ");
    }
    else{
        pg.connect(process.env.DATABASE_URL,function(err,client,done){
            if (err) {
                console.log(err);
                return res.sendStatus(500);
            }
            client.query("INSERT INTO harems (nickname,haremname,haremdesc) VALUES ($1,$2,$3) RETURNING haremid",
                [req.params.iduser,req.body.haremName,req.body.haremDesc], function(err,result){
                done(client);
                if(err){
                    console.log(err);
                    return res.sendStatus(500);
                }
                return callback(req,res,result.rows[0].idharem);
            });
        });
    }
}
exports.insertHarem = insertHarem;

var insertWedding = function(req,res,callback){
    if (req.session.login != req.params.iduser) {
        return res.status(401).send("You aren't authentified ")
    }else{
        pg.connect(process.env.DATABASE_URL,function(err,client,done){
            if (err) {
                console.log(err);
                return res.sendStatus(500);
            }
            client.query("INSERT INTO weddings (haremid, charid, weddesc, favorite) VALUES ($1,$2,$3,$4)",
                [req.params.idharem, req.body.CharId, req.body.WedDesc, req.body.Favorite],
                function(err,result){
                done(client);
                if(err){
                    console.log(err);
                    return res.sendStatus(500);
                }
                return callback(req, res, req.body.CharId);
            });
        });
    }
}
exports.insertWedding = insertWedding;